/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2009 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Data declarations

extern _UNKNOWN start; // weak
extern int dword_8049F14; // weak
extern int dword_8049F1C[]; // weak
extern _UNKNOWN unk_8049F20; // weak
extern int dword_8049F24; // weak
extern char byte_804A024; // weak
extern int dword_804A028; // weak
// extern _UNKNOWN _gmon_start__; weak

//-------------------------------------------------------------------------
// Function declarations

void (*__cdecl init_proc())(void);
int __fastcall __stack_chk_fail(_DWORD, _DWORD); // weak
int __gmon_start__(void); // weak
void __cdecl sub_80484F0();
int __cdecl sub_8048550();
int __cdecl checkPassword(int a1, signed int a2);
int *__cdecl sub_8048AC0();
void __cdecl sub_8048B32();
void (*__cdecl sub_8048B40())(void);
void __cdecl term_proc();


//----- (08048380) --------------------------------------------------------
void (*__cdecl init_proc())(void)
{
  if ( &_gmon_start__ )
    __gmon_start__();
  sub_8048550();
  return sub_8048B40();
}
// 80483F0: using guessed type int __gmon_start__(void);

//----- (080484CC) --------------------------------------------------------
#error "80484CF: positive sp value has been found (funcsize=2)"

//----- (080484F0) --------------------------------------------------------
void __cdecl sub_80484F0()
{
  int v0; // eax@2
  int i; // ebx@2

  if ( !byte_804A024 )
  {
    v0 = dword_804A028;
    for ( i = ((signed int)(&unk_8049F20 - (_UNKNOWN *)dword_8049F1C) >> 2) - 1;
          dword_804A028 < (unsigned int)i;
          v0 = dword_804A028 )
    {
      dword_804A028 = v0 + 1;
      ((void (*)(void))dword_8049F1C[dword_804A028])();
    }
    byte_804A024 = 1;
  }
}
// 8049F1C: using guessed type int dword_8049F1C[];
// 804A024: using guessed type char byte_804A024;
// 804A028: using guessed type int dword_804A028;

//----- (08048550) --------------------------------------------------------
int __cdecl sub_8048550()
{
  int result; // eax@1

  result = dword_8049F24;
  if ( dword_8049F24 )
    result = 0;
  return result;
}
// 8049F24: using guessed type int dword_8049F24;

//----- (08048580) --------------------------------------------------------
int __cdecl checkPassword(int a1, signed int a2)
{
  signed int v2; // edx@1
  int v3; // ecx@2
  int v4; // ebp@2
  unsigned int v5; // edi@2
  int result; // eax@3
  char v7[33]; // [sp+Ch] [bp-A0h]@2
  char v8; // [sp+2Dh] [bp-7Fh]@38
  char v9; // [sp+2Eh] [bp-7Eh]@41
  char v10; // [sp+30h] [bp-7Ch]@47
  char v11; // [sp+31h] [bp-7Bh]@50
  char v12; // [sp+32h] [bp-7Ah]@52
  char v13; // [sp+33h] [bp-79h]@57
  char v14; // [sp+35h] [bp-77h]@60
  char v15; // [sp+36h] [bp-76h]@63
  char v16; // [sp+37h] [bp-75h]@65
  char v17; // [sp+38h] [bp-74h]@67
  char v18; // [sp+39h] [bp-73h]@70
  char v19; // [sp+3Ah] [bp-72h]@73
  char v20; // [sp+3Ch] [bp-70h]@78
  char v21; // [sp+3Dh] [bp-6Fh]@81
  char v22; // [sp+3Eh] [bp-6Eh]@84
  char v23; // [sp+3Fh] [bp-6Dh]@87
  char v24; // [sp+40h] [bp-6Ch]@55
  char v25; // [sp+41h] [bp-6Bh]@91
  char v26; // [sp+42h] [bp-6Ah]@94
  char v27; // [sp+43h] [bp-69h]@97
  char v28; // [sp+44h] [bp-68h]@100
  char v29; // [sp+45h] [bp-67h]@103
  char v30; // [sp+56h] [bp-56h]@7
  char v31; // [sp+7Ch] [bp-30h]@9
  char v32; // [sp+7Dh] [bp-2Fh]@12
  char v33; // [sp+7Eh] [bp-2Eh]@15
  char v34; // [sp+7Fh] [bp-2Dh]@18
  char v35; // [sp+80h] [bp-2Ch]@21
  char v36; // [sp+81h] [bp-2Bh]@24
  char v37; // [sp+82h] [bp-2Ah]@27
  char v38; // [sp+83h] [bp-29h]@30
  char v39; // [sp+85h] [bp-27h]@32
  int v40; // [sp+8Ch] [bp-20h]@1

  v40 = *MK_FP(__GS__, 20);
  v2 = a2;
  while ( 2 )
  {
    memset(v7, 0, 0x80u);
    v4 = *(_BYTE *)(a1 + v2);
    v5 = (unsigned int)(*(_BYTE *)(a1 + v2) + 64) >> 56;
    v7[((v5 + *(_BYTE *)(a1 + v2) + 64) & 0x7F) - v5] = 1;
    v3 = v4 - 10;
    if ( (unsigned __int8)(v4 - 10) <= 0x70u )
    {
      v3 = (unsigned __int8)v3;
      switch ( (_BYTE)v3 )
      {
        default:
          goto endJumpTable;
        case 0:
          result = v2 == 13 & v30 != 0;
          break;
        case 0x26:
          if ( v2 || !v31 )
            goto endJumpTable;
          v2 = 1;
          continue;
        case 0x27:
          if ( v2 == 14 && v32 )
            goto LABEL_13;
          goto endJumpTable;
        case 0x28:
          if ( v2 == 20 && v33 )
            goto LABEL_16;
          goto endJumpTable;
        case 0x29:
          if ( v2 != 89 || !v34 )
            goto endJumpTable;
          v2 = 90;
          continue;
        case 0x2A:
          if ( v2 != 15 || !v35 )
            goto endJumpTable;
          v2 = 16;
          continue;
        case 0x2B:
          if ( v2 != 14 || !v36 )
            goto endJumpTable;
LABEL_13:
          v2 = 15;
          continue;
        case 0x2C:
          if ( v2 != 12 || !v37 )
            goto endJumpTable;
          v2 = 13;
          continue;
        case 0x2D:
          if ( v2 != 5 || !v38 )
            goto endJumpTable;
          v2 = 6;
          continue;
        case 0x2E:
          result = 0;
          if ( v39 )
            result = v2 == 33 | v2 == 2;
          goto endJumpTable_0;
        case 0x2F:
          if ( v2 != 1 || !v39 )
            goto endJumpTable;
          v2 = 2;
          continue;
        case 0x57:
          if ( v2 != 35 || !v8 )
            goto endJumpTable;
          v2 = 36;
          continue;
        case 0x58:
          if ( v2 != 11 || !v9 )
            goto endJumpTable;
          v2 = 12;
          continue;
        case 0x59:
          if ( v2 != 32 || !v8 )
            goto endJumpTable;
          v2 = 33;
          continue;
        case 0x5A:
          if ( v2 != 3 || !v10 )
            goto endJumpTable;
          v2 = 4;
          continue;
        case 0x5B:
          if ( v2 != 7 || !v11 )
            goto endJumpTable;
          v2 = 8;
          continue;
        case 0x5C:
          if ( !v12 || v2 != 8 && v2 != 4 )
            goto endJumpTable;
          goto LABEL_54;
        case 0x5D:
          result = v2 == 12 & v24 != 0;
          goto endJumpTable_0;
        case 0x5E:
          if ( v2 != 13 || !v13 )
            goto endJumpTable;
          v2 = 14;
          continue;
        case 0x5F:
          if ( v2 != 9 || !v14 )
            goto endJumpTable;
          v2 = 10;
          continue;
        case 0x60:
          if ( v2 != 10 || !v15 )
            goto endJumpTable;
          v2 = 11;
          continue;
        case 0x61:
          result = v2 == 12 & v16 != 0;
          goto endJumpTable_0;
        case 0x62:
          if ( v2 != 19 || !v17 )
            goto endJumpTable;
          v2 = 20;
          continue;
        case 0x63:
          if ( v2 != 17 || !v18 )
            goto endJumpTable;
          v2 = 18;
          continue;
        case 0x64:
          result = v2 == 18 & v18 != 0;
          goto endJumpTable_0;
        case 0x65:
          if ( !v19 || v2 != 6 && v2 != 28 )
            goto endJumpTable;
LABEL_54:
          ++v2;
          continue;
        case 0x66:
          if ( v2 != 30 || !v20 )
            goto endJumpTable;
          v2 = 31;
          continue;
        case 0x67:
          if ( v2 != 29 || !v21 )
            goto endJumpTable;
          v2 = 30;
          continue;
        case 0x68:
          if ( v2 != 20 || !v22 )
            goto endJumpTable;
LABEL_16:
          v2 = 21;
          continue;
        case 0x69:
          if ( v2 != 25 || !v23 )
            goto endJumpTable;
          v2 = 26;
          continue;
        case 0x6A:
          result = v2 == 24 & v22 != 0;
          goto endJumpTable_0;
        case 0x6B:
          if ( v2 != 26 || !v25 )
            goto endJumpTable;
          v2 = 27;
          continue;
        case 0x6C:
          if ( v2 != 2 || !v26 )
            goto endJumpTable;
          v2 = 3;
          continue;
        case 0x6D:
          if ( v2 != 6 || !v27 )
            goto endJumpTable;
          v2 = 7;
          continue;
        case 0x6E:
          if ( v2 != 22 || !v28 )
            goto endJumpTable;
          v2 = 23;
          continue;
        case 0x6F:
          if ( v2 != 23 || !v29 )
            goto endJumpTable;
          v2 = 24;
          continue;
        case 0x70:
          result = v2 == 21 & v8 != 0;
          break;
      }
    }
    else
    {
endJumpTable:
      result = 0;
    }
    break;
  }
endJumpTable_0:
  if ( *MK_FP(__GS__, 20) != v40 )
    __stack_chk_fail(v3, *MK_FP(__GS__, 20) ^ v40);
  return result;
}
// 80483E0: using guessed type int __fastcall __stack_chk_fail(_DWORD, _DWORD);
// 8048580: using guessed type char var_A0[33];

//----- (08048AC0) --------------------------------------------------------
int *__cdecl sub_8048AC0()
{
  init_proc();
  return &dword_8049F14;
}
// 8049F14: using guessed type int dword_8049F14;

//----- (08048B32) --------------------------------------------------------
void __cdecl sub_8048B32()
{
  ;
}

//----- (08048B40) --------------------------------------------------------
void (*__cdecl sub_8048B40())(void)
{
  void (*result)(void); // eax@1
  int *v1; // ebx@2

  result = (void (*)(void))dword_8049F14;
  if ( dword_8049F14 != -1 )
  {
    v1 = &dword_8049F14;
    do
    {
      --v1;
      result();
      result = (void (*)(void))*v1;
    }
    while ( *v1 != -1 );
  }
  return result;
}
// 8049F14: using guessed type int dword_8049F14;

//----- (08048B6C) --------------------------------------------------------
void __cdecl term_proc()
{
  sub_80484F0();
}

#error "There were 1 decompilation failure(s) on 9 function(s)"
